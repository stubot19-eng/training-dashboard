<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bryce Training Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        header {
            text-align: center;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2cbf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        .subtitle { color: #888; font-size: 1rem; }
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(0,212,255,0.1);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 12px;
        }
        .live-dot {
            width: 8px; height: 8px;
            background: #00ff88;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .card {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }
        .card-label { color: #00d4ff; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .card-value { font-size: 1.8rem; font-weight: 700; color: #fff; }
        .card-sub { color: #666; font-size: 0.85rem; margin-top: 4px; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .section h2 {
            color: #00d4ff;
            font-size: 1.2rem;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .macro-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .macro {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .macro.calories { border-left: 3px solid #a855f7; }
        .macro.protein { border-left: 3px solid #ef4444; }
        .macro.carbs { border-left: 3px solid #22c55e; }
        .macro.fats { border-left: 3px solid #eab308; }
        .macro-label { color: #888; font-size: 0.75rem; text-transform: uppercase; }
        .macro-value { font-size: 1.4rem; font-weight: 700; margin: 6px 0; }
        .workout-list { max-height: 500px; overflow-y: auto; }
        .workout-item {
            background: rgba(0,0,0,0.3);
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-left: 3px solid #00d4ff;
        }
        .workout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .workout-type {
            font-weight: 600;
            color: #fff;
            font-size: 1.1rem;
        }
        .workout-date { color: #666; font-size: 0.85rem; }
        .workout-exercises { color: #aaa; font-size: 0.9rem; line-height: 1.6; }
        .exercise-item { padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .exercise-item:last-child { border-bottom: none; }
        .pr-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: #000;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 8px;
        }
        .program-day {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .program-day h4 { color: #fff; margin-bottom: 10px; }
        .program-day p { color: #888; font-size: 0.9rem; line-height: 1.8; }
        .program-day.rest { border-left: 3px solid #666; opacity: 0.7; }
        .program-day:not(.rest) { border-left: 3px solid #00d4ff; }
        @media (max-width: 600px) {
            .macro-grid { grid-template-columns: repeat(2, 1fr); }
            .grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèãÔ∏è Bryce's Training Dashboard</h1>
            <p class="subtitle"><span id="height">6'4"</span> | <span id="age">31</span> years old | Lean Bulk</p>
            <div class="live-indicator">
                <span class="live-dot"></span>
                <span>Live ‚Ä¢ Updates every 30s</span>
            </div>
        </header>

        <div class="grid">
            <div class="card">
                <div class="card-label">Current Weight</div>
                <div class="card-value"><span id="weight">193</span> lb</div>
            </div>
            <div class="card">
                <div class="card-label">Total Workouts</div>
                <div class="card-value"><span id="workout-count">0</span></div>
            </div>
            <div class="card">
                <div class="card-label">DB Bench PR</div>
                <div class="card-value"><span id="pr-bench">--</span> lb</div>
            </div>
            <div class="card">
                <div class="card-label">Lat Pulldown PR</div>
                <div class="card-value"><span id="pr-pulldown">--</span> lb</div>
            </div>
        </div>

        <div class="section">
            <h2>üéØ Daily Macros (Lean Bulk)</h2>
            <div class="macro-grid">
                <div class="macro calories">
                    <div class="macro-label">Calories</div>
                    <div class="macro-value" id="calories">3,300</div>
                </div>
                <div class="macro protein">
                    <div class="macro-label">Protein</div>
                    <div class="macro-value"><span id="protein">195</span>g</div>
                </div>
                <div class="macro carbs">
                    <div class="macro-label">Carbs</div>
                    <div class="macro-value"><span id="carbs">480</span>g</div>
                </div>
                <div class="macro fats">
                    <div class="macro-label">Fats</div>
                    <div class="macro-value"><span id="fats">70</span>g</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìÖ 6-Week Program</h2>
            <div class="program-day">
                <h4>Day 1: Push Heavy</h4>
                <p>DB Bench 4√ó6-8 ‚Ä¢ Incline Press 3√ó8-10 ‚Ä¢ Shoulder Press 3√ó8-10 ‚Ä¢ Lateral Raises 3√ó12-15 ‚Ä¢ Tricep Pushdowns 3√ó12</p>
            </div>
            <div class="program-day">
                <h4>Day 2: Pull Heavy</h4>
                <p>Lat Pulldown 4√ó6-8 ‚Ä¢ Chest-Supported Row 3√ó8-10 ‚Ä¢ Seated Row 3√ó10-12 ‚Ä¢ Face Pulls 3√ó15 ‚Ä¢ Barbell Curls 3√ó10</p>
            </div>
            <div class="program-day">
                <h4>Day 3: Legs</h4>
                <p>Leg Press 4√ó10-12 ‚Ä¢ Romanian Deadlift 3√ó8-10 ‚Ä¢ Leg Curl 3√ó12-15 ‚Ä¢ Calf Raises 4√ó15 ‚Ä¢ Plank 3√ó60s</p>
            </div>
            <div class="program-day rest">
                <h4>Day 4: Rest</h4>
                <p>Active recovery, stretching, meal prep</p>
            </div>
            <div class="program-day">
                <h4>Day 5: Upper Volume</h4>
                <p>DB Bench 3√ó10-12 ‚Ä¢ Cable Row 3√ó12-15 ‚Ä¢ Lat Pulldown 3√ó12 ‚Ä¢ Lateral Raises 3√ó15 ‚Ä¢ Curls + Pushdowns 3√ó15</p>
            </div>
            <div class="program-day rest">
                <h4>Days 6-7: Rest</h4>
                <p>Full recovery, sleep focus</p>
            </div>
        </div>

        <div class="section">
            <h2>üìä Workout History</h2>
            <div class="workout-list" id="workout-list">
                <p style="color: #666; text-align: center; padding: 40px;">Loading workouts...</p>
            </div>
        </div>
    </div>

    <script>
        async function loadStats() {
            try {
                const res = await fetch('/api/stats');
                const data = await res.json();
                
                document.getElementById('weight').textContent = data.weight || 193;
                document.getElementById('workout-count').textContent = data.workout_count || 0;
                document.getElementById('calories').textContent = (data.calories || 3300).toLocaleString();
                document.getElementById('protein').textContent = data.protein || 195;
                document.getElementById('carbs').textContent = data.carbs || 480;
                document.getElementById('fats').textContent = data.fats || 70;
                
                // Update PRs
                const prs = data.prs || {};
                const benchPR = Object.entries(prs).find(([k]) => k.toLowerCase().includes('bench'));
                const pulldownPR = Object.entries(prs).find(([k]) => k.toLowerCase().includes('pulldown'));
                
                if (benchPR) document.getElementById('pr-bench').textContent = benchPR[1];
                if (pulldownPR) document.getElementById('pr-pulldown').textContent = pulldownPR[1];
            } catch (e) {
                console.error('Failed to load stats:', e);
            }
        }

        async function loadWorkouts() {
            try {
                const res = await fetch('/api/workouts');
                const workouts = await res.json();
                const container = document.getElementById('workout-list');
                
                if (workouts.length === 0) {
                    container.innerHTML = '<p style="color: #666; text-align: center; padding: 40px;">No workouts logged yet. Text Stu to add your first workout!</p>';
                    return;
                }
                
                container.innerHTML = workouts.map(w => `
                    <div class="workout-item">
                        <div class="workout-header">
                            <span class="workout-type">${w.type || 'Workout'}</span>
                            <span class="workout-date">${w.date || 'No date'}${w.bodyweight ? ' ‚Ä¢ ' + w.bodyweight + ' lb' : ''}</span>
                        </div>
                        <div class="workout-exercises">
                            ${w.exercises.map(e => `
                                <div class="exercise-item">
                                    <strong>${e.name}</strong>: ${e.weight || '--'}lb √ó ${e.reps || '--'} reps${e.sets > 1 ? ' √ó ' + e.sets + ' sets' : ''}
                                </div>
                            `).join('')}
                        </div>
                        ${w.notes ? `<div style="color: #666; margin-top: 10px; font-size: 0.85rem;">üìù ${w.notes}</div>` : ''}
                    </div>
                `).join('');
            } catch (e) {
                console.error('Failed to load workouts:', e);
            }
        }

        // Initial load
        loadStats();
        loadWorkouts();

        // Auto-refresh every 30 seconds
        setInterval(() => {
            loadStats();
            loadWorkouts();
        }, 30000);
    </script>
</body>
</html>
